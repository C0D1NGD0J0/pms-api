echo "ğŸ” Running pre-commit checks..."

# Run linting first to check for errors
echo "ğŸ“‹ Checking for lint errors..."
if ! npm run lint; then
  echo "âš ï¸  Lint errors found. Attempting to auto-fix..."

  # Try to auto-fix lint errors
  npm run lint:fix

  # Format code with prettier
  echo "ğŸ¨ Formatting code with Prettier..."
  npm run prettier:write

  # Stage any files that were fixed
  echo "ğŸ“¦ Staging fixed files..."
  git add .

  # Run lint again to check if issues are resolved
  echo "ğŸ” Re-checking for remaining lint errors..."
  if ! npm run lint; then
    echo "âŒ Lint errors remain after auto-fix. Please fix manually before committing."
    exit 1
  fi

  echo "âœ… All lint issues auto-fixed successfully!"
else
  echo "âœ… No lint errors found!"

  # Still run prettier to ensure consistent formatting
  echo "ğŸ¨ Running Prettier to ensure consistent formatting..."
  npm run prettier:write

  # Stage any formatting changes
  git add .
fi

echo "âœ… Pre-commit checks passed!"
